<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Official page of Avishikta - I Type - A RWA. Stay informed, get involved, and build a stronger association.">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta name="theme-color" content="#000000" />
  <!-- Choices.js CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />

<!-- Choices.js JS -->
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

  <script src="layout.js" defer></script>
  <title>Events & Photo Gallery â€“ Avishikta</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      background-color: #f9fafb;
      color: #333;
      padding-top: 54px;
      padding-left: 260px;
      padding-bottom: 60px;
      transition: padding-left 0.3s ease;
      min-height: 100vh;
    }
    @media (max-width: 768px) {
      body {
        padding-left: 0;
      }
    }
    main {
      max-width: 1200px;
      margin: 20px auto;
      padding: 0 1rem;
      box-sizing: border-box;
    }
    .events-header {
      text-align: center;
      margin-bottom: 1rem;
      color: #2a72d8;
      margin-top: -2rem;
    }
    .events-header h1 {
      font-weight: 700;
      font-size: 2.4rem;
      margin-bottom: 0.3rem;
      text-shadow: 1px 1px 2px rgba(42,114,216,0.3);
    }
    .events-header p {
      font-weight: 500;
      font-size: 1.1rem;
      color: #555;
      max-width: 650px;
      margin: 0 auto;
    }
    /* Masonry gallery */
  .gallery {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  justify-content: space-between;
  position: relative;
  z-index: 1;
}

.image-container {
  width: calc(33.333% - 11px); /* Slightly adjust for consistent gap */
  margin: 0; /* Remove individual margins */
  position: relative;
  break-inside: avoid;
  border-radius: 10px;
  background: white;
  box-shadow: 0 4px 10px rgb(42 114 216 / 0.15);
  overflow: hidden;
  transition: box-shadow 0.3s ease;
  cursor: default;
  user-select: none;
  box-sizing: border-box;
}

@media (max-width: 1024px) {
  .image-container {
    width: calc(50% - 1rem);
  }
}

@media (max-width: 600px) {
  .image-container {
    width: 100%;
    margin-left: 0;
  }
}

    .image-container:hover,
    .image-container:focus-within {
      box-shadow: 0 8px 25px rgb(42 114 216 / 0.35);
    }

    /* Image reduced size */
  .image-container img {
  width: 100%;
  height: 220px;
  object-fit: cover;
  background-color: #fff;
  object-position: top; /* ðŸ‘ˆ Focus on top part (so head remains visible) */
}

    .image-container:hover img,
    .image-container:focus-within img {
      transform: scale(1.05);
    }

    /* Caption bar below image - hidden normally, shown on hover */
    .caption {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      background: linear-gradient(90deg, #6a0dad, #9b30ff);
      color: white;
      text-align: center;
      font-weight: 600;
      padding: 6px 0;
      font-size: 0.85rem;
      border-radius: 0 0 10px 10px;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
      user-select: none;
      line-height: 1.4;
    }
    .image-container:hover .caption,
    .image-container:focus-within .caption {
      opacity: 1;
      pointer-events: auto;
    }

    /* Icon buttons container */
    .icon-btn {
      position: absolute;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      border: none;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: background-color 0.3s ease, opacity 0.3s ease;
      color: white;
      box-shadow: 0 2px 8px rgb(0 0 0 / 0.2);
      user-select: none;
      opacity: 0;
      pointer-events: none;
    }

    /* Show icon buttons on hover or focus within container */
    .image-container:hover .icon-btn,
    .image-container:focus-within .icon-btn {
      opacity: 1;
      pointer-events: auto;
    }

    /* Positions */
    .download-btn {
      top: 10px;
      left: 10px;
      background: #43a047; /* green */
    }
    .download-btn:hover,
    .download-btn:focus {
      background: #388e3c;
      outline: none;
    }

    .zoom-btn {
      top: 10px;
      right: 10px;
      background: #1e88e5; /* blue */
    }
    .zoom-btn:hover,
    .zoom-btn:focus {
      background: #1565c0;
      outline: none;
    }

    .delete-btn {
      bottom: 10px;
      right: 10px;
      background: #e53935; /* red */
    }
    .delete-btn:hover,
    .delete-btn:focus {
      background: #b71c1c;
      outline: none;
    }

    /* Smaller icons */
    .icon-btn svg {
      width: 16px;
      height: 16px;
      fill: white;
      pointer-events: none;
      user-select: none;
    }

    /* Undo Toast */
    #undo-toast {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      background: #2a72d8;
      padding: 12px 24px;
      border-radius: 30px;
      box-shadow: 0 4px 12px rgb(255 126 95 / 0.6);
      color: white;
      font-weight: 600;
      display: none;
      align-items: center;
      gap: 1rem;
      z-index: 10001;
      user-select: none;
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    #undo-toast.show {
      display: flex;
      opacity: 1;
    }
    #undo-toast button {
      background: white;
      color: #2a72d8;
      border: none;
      border-radius: 20px;
      padding: 6px 14px;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 2px 8px rgb(255 126 95 / 0.5);
      transition: background 0.3s ease, color 0.3s ease;
    }
    #undo-toast button:hover,
    #undo-toast button:focus {
      background: #1d4ed8;
      color: white;
      outline: none;
    }

    /* Zoom modal */
    #zoom-modal {
      position: fixed;
      top: 54px;
      left: 260px;
      right: 0;
      bottom: 60px;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      padding: 1rem;
    }
    @media (max-width: 768px) {
  #zoom-modal {
    left: 0;
    top: 0;
    bottom: 0;
    padding-top: 54px;
  }

  .zoom-controls {
    bottom: 20px;
    right: 20px;
    gap: 10px;
  }
  .zoom-control {
    width: 36px;
    height: 36px;
    font-size: 1.4rem;
  }
 }

    #zoom-modal img {
      max-width: 90%;
      max-height: calc(100vh - 40px - 50px - 50px);
      border-radius: 14px;
      box-shadow: 0 8px 30px rgb(42 114 216 / 0.6);
      user-select: none;
      pointer-events: none;
      object-fit: contain;
    }
    #zoom-modal .close-btn {
      position: absolute;
      top: 20px;
      right: 30px;
      background: #feb47b;
      border: none;
      border-radius: 50%;
      width: 38px;
      height: 38px;
      color: white;
      font-weight: 700;
      font-size: 1.5rem;
      line-height: 1;
      cursor: pointer;
      box-shadow: 0 3px 10px rgb(255 126 95 / 0.7);
      transition: background 0.3s ease;
      user-select: none;
    }
    #zoom-modal .close-btn:hover,
    #zoom-modal .close-btn:focus {
      background: #ff7e5f;
      outline: none;
    }

    /* Go to Top Button */
    #go-top-btn {
      position: fixed;
      bottom: 16px;
      right: 16px;
      background: #2a72d8;
      border: none;
      border-radius: 50%;
      width: 42px;
      height: 42px;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 4px 12px rgb(42 114 216 / 0.7);
      user-select: none;
      transition: background 0.3s ease;
      z-index: 10001;
    }
    #go-top-btn:hover,
    #go-top-btn:focus {
      background: #feb47b;
      color: #2a72d8;
      outline: none;
    }
    /* Make caption always visible on mobile */
    @media (max-width: 768px) {
      .image-container .caption {
        opacity: 1 !important;
        pointer-events: auto !important;
      }
    }
    /* Focus styles for accessibility */
    .image-container:focus-within,
    .icon-btn:focus {
      outline: 2px solid #2a72d8;
      outline-offset: 2px;
    }

    /* Zoom control buttons */
/* Individual zoom button style */
.zoom-control {
  width: 42px;
  height: 42px;
  background: #1e88e5;
  color: white;
  border: none;
  border-radius: 50%;
  font-size: 1.6rem;
  font-weight: bold;
  line-height: 1;
  cursor: pointer;
  box-shadow: 0 3px 10px rgb(30 136 229 / 0.7);
  display: flex;
  justify-content: center;
  align-items: center;
  transition: background 0.3s ease;
}
.zoom-controls {
  position: absolute;
  bottom: 40px;
  right: 40px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  z-index: 10001;
}
#zoom-in-btn {
  right: 70px;
}
#zoom-out-btn {
  right: 20px;
}
.zoom-control:hover,
.zoom-control:focus {
  background: #1565c0;
  outline: none;
}

/* Spinner styles */
.spinner {
  width: 40px;
  height: 40px;
  position: relative;
  margin: 2rem auto;
}

.double-bounce1, .double-bounce2 {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  background-color: #2a72d8;
  opacity: 0.6;
  position: absolute;
  top: 0; left: 0;
  animation: bounce 2s infinite ease-in-out;
}

.double-bounce2 {
  animation-delay: -1s;
}

@keyframes bounce {
  0%, 100% {
    transform: scale(0);
  }
  50% {
    transform: scale(1);
  }
}

#event-filter option:hover {
    background-color: #cce4ff;
    color: #004a99;
  }

  #event-filter:focus {
    border-color: #1a73e8;
    box-shadow: 0 0 8px #1a73e8;
  }

/* Make sure the dropdown container is above gallery */
.choices__list--dropdown {
  z-index: 9999 !important;  /* Dropdown itself above everything */
  position: absolute;
}

</style>
</head>
<body>
  <main>
    <section class="events-header">
      <h1>Events & Photo Gallery</h1>
      <p>Enjoy the beautiful memories captured in our photo gallery.</p>
    </section>
    
    <!-- ðŸ” Search bar for filtering images -->
<section style="text-align: center; margin: 1rem 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
  <label for="event-filter" style="font-weight: 700; font-size: 1.1rem; display: block; margin-bottom: 0.5rem; color: #333;">
    Filter by Event:
  </label>
  <select id="event-filter" multiple>
    <option value="AGM">AGM</option>
    <option value="Khuti Puja">Khuti Puja</option>
    <option value="Independence Day">Independence Day</option>
    <option value="Biswakarma Puja">Biswakarma Puja</option>
    <option value="Durga Puja">Durga Puja</option>
    <option value="Kali Puja">Kali Puja</option>
    <option value="Other">Other</option>
  </select>
</section>
     
<div id="spinner" class="spinner" aria-live="polite" aria-busy="true" role="status" aria-label="Loading images">
  <div class="double-bounce1"></div>
  <div class="double-bounce2"></div>
</div>

<section class="gallery" aria-label="Event photo gallery"></section>

</main>

  <!-- Undo toast -->
  <div id="undo-toast" role="alert" aria-live="assertive" aria-atomic="true">
    Image deleted.
    <button id="undo-btn" aria-label="Undo delete">Undo</button>
  </div>

  <!-- Zoom modal -->
  <div id="zoom-modal" role="dialog" aria-modal="true" aria-label="Zoomed image" tabindex="-1">
  <button class="close-btn" aria-label="Close zoom modal">&times;</button>
  
  <!-- New zoom control container -->
  <div class="zoom-controls">
    <button id="zoom-in-btn" class="zoom-control" aria-label="Zoom In">+</button>
    <button id="zoom-out-btn" class="zoom-control" aria-label="Zoom Out">âˆ’</button>
  </div>

  <img src="" alt="Zoomed event" />
</div>
  
  <!-- Go to top button -->
  <button id="go-top-btn" aria-label="Go to top">&#8679;</button>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const eventFilter = document.getElementById('event-filter');
  const gallery = document.querySelector('.gallery');
  const spinner = document.getElementById('spinner');
  const goTopBtn = document.getElementById('go-top-btn');
  const undoToast = document.getElementById('undo-toast');
  const undoBtn = document.getElementById('undo-btn');
  const zoomModal = document.getElementById('zoom-modal');
  const zoomImage = zoomModal.querySelector('img');
  const zoomCloseBtn = zoomModal.querySelector('.close-btn');
  const zoomInBtn = document.getElementById('zoom-in-btn');
  const zoomOutBtn = document.getElementById('zoom-out-btn');

goTopBtn.style.display = 'none';

// Show button on scroll down, hide when near top
  window.addEventListener('scroll', () => {
    if (window.scrollY > 200) {
      goTopBtn.style.display = 'block';
    } else {
      goTopBtn.style.display = 'none';
    }
  });

  // Smooth scroll to top on click
  goTopBtn.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  let deletedImageData = null;
  let deletedImageIndex = null;
  let currentZoom = 1;
  const zoomStep = 0.2;
  const zoomMax = 3;
  const zoomMin = 0.5;
  let lastFocusedElement;

  // Sample image array â€” replace or extend as needed
  const imageArray = [
  { path: 'indepen2025.jpg', name: 'Image-1.jpg', caption: '79th Independence Day | Avishikta - 1', event: 'Independence Day' },
    { path: '19thagm-1.jpg', name: 'Image-2.jpg', caption: '19th AGM - View 1', event: 'AGM' },
  { path: '19thagm-3.jpg', name: 'Image-3.jpg', caption: '19th AGM - View 2', event: 'AGM' },
  { path: '19thagm-6.jpg', name: 'Image-4.jpg', caption: '19th AGM - View 3', event: 'AGM' },
 { path: '19thagm-4.jpg', name: 'Image-5.jpg', caption: '19th AGM - View 4', event: 'AGM' },
  { path: '19thagm-5.jpg', name: 'Image-6.jpg', caption: '19th AGM - View 5', event: 'AGM' },
  { path: 'img-5.jpg', name: 'Image-7.jpg', caption: 'Type-A', event: 'Other' },
  { path: 'khutipujo-1.jpg', name: 'Image-8.jpg', caption: 'Khuti Puja 2025', event: 'Khuti Puja' }
  ];

  // Initialize Choices.js for multi-select dropdown
  const choices = new Choices(eventFilter, {
    removeItemButton: true,
    searchEnabled: true,
    placeholder: true,
    placeholderValue: 'Select event(s)',
    searchPlaceholderValue: 'Search events',
    shouldSort: false,
    itemSelectText: '',
  });

  // Render gallery images filtered by caption and selected events
  function renderGallery(filterText = '') {
    spinner.style.display = 'block';
    gallery.innerHTML = '';

    setTimeout(() => {
      let selectedEvents = [];
      try {
        selectedEvents = choices.getValue(true); // returns array of selected event values
      } catch (e) {
        console.error('Error getting selected events:', e);
      }

      const filteredImages = imageArray.filter(({ caption, event }) => {
        const matchesCaption = caption.toLowerCase().includes(filterText.toLowerCase());
        const matchesEvent = selectedEvents.length === 0 || selectedEvents.includes(event);
        return matchesCaption && matchesEvent;
      });

      if (filteredImages.length === 0) {
        const message = document.createElement('p');
        message.textContent = 'No images found for this search.';
        message.style.textAlign = 'center';
        message.style.color = '#888';
        message.style.fontWeight = '600';
        gallery.appendChild(message);
        spinner.style.display = 'none';
        return;
      }

      filteredImages.forEach(({ path, name, caption }, idx) => {
        const container = document.createElement('article');
        container.className = 'image-container';
        container.tabIndex = 0;
        container.setAttribute('aria-label', caption);

        const img = document.createElement('img');
        img.src = path;
        img.alt = caption;
        img.loading = 'lazy';
        img.draggable = false;
        container.appendChild(img);

        const captionBar = document.createElement('div');
        captionBar.className = 'caption';
        captionBar.textContent = caption;
        container.appendChild(captionBar);

        // Download Button
        const downloadBtn = document.createElement('button');
        downloadBtn.className = 'icon-btn download-btn';
        downloadBtn.title = `Download ${name}`;
        downloadBtn.innerHTML = `â¬‡ï¸`;
        downloadBtn.type = 'button';
        downloadBtn.tabIndex = 0;
        downloadBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          const link = document.createElement('a');
          link.href = path;
          link.download = name;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        });
        container.appendChild(downloadBtn);

        // Zoom Button
        const zoomBtn = document.createElement('button');
        zoomBtn.className = 'icon-btn zoom-btn';
        zoomBtn.title = `Zoom ${caption}`;
        zoomBtn.innerHTML = `ðŸ”`;
        zoomBtn.type = 'button';
        zoomBtn.tabIndex = 0;
        zoomBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          openZoom(path, caption);
        });
        container.appendChild(zoomBtn);

        // Delete Button
        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'icon-btn delete-btn';
        deleteBtn.title = `Delete ${caption}`;
        deleteBtn.innerHTML = `ðŸ—‘ï¸`;
        deleteBtn.type = 'button';
        deleteBtn.tabIndex = 0;
        deleteBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          deleteImage(imageArray.indexOf(filteredImages[idx]));
        });
        container.appendChild(deleteBtn);

        gallery.appendChild(container);
      });

      new Masonry(gallery, {
        itemSelector: '.image-container',
        columnWidth: '.image-container',
        percentPosition: true,
        gutter: 16,
      });

      spinner.style.display = 'none';
    }, 300);
  }

  // Dropdown change triggers gallery re-render
  eventFilter.addEventListener('change', () => {
    renderGallery();
   choices.hideDropdown();
  });

  // Zoom modal functions
  function openZoom(src, alt) {
    zoomImage.src = src;
    zoomImage.alt = alt;
    zoomModal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
    zoomModal.focus();
    lastFocusedElement = document.activeElement;
    currentZoom = 1;
    zoomImage.style.transform = `scale(1)`;

    zoomModal.addEventListener('keydown', trapFocus);

    const focusableElements = zoomModal.querySelectorAll('button, img');
    let firstEl = focusableElements[0];
    let lastEl = focusableElements[focusableElements.length - 1];

    function trapFocus(e) {
      if (e.key === 'Tab') {
        if (e.shiftKey && document.activeElement === firstEl) {
          e.preventDefault();
          lastEl.focus();
        } else if (!e.shiftKey && document.activeElement === lastEl) {
          e.preventDefault();
          firstEl.focus();
        }
      } else if (e.key === 'Escape') {
        closeZoom();
      } else if (e.key === '+' || e.key === '=') {
        zoomInBtn.click();
      } else if (e.key === '-' || e.key === '_') {
        zoomOutBtn.click();
      }
    }
  }

  function closeZoom() {
    zoomModal.style.display = 'none';
    zoomImage.src = '';
    document.body.style.overflow = '';
    zoomModal.removeEventListener('keydown', trapFocus);
    if (lastFocusedElement) lastFocusedElement.focus();
    currentZoom = 1;
    zoomImage.style.transform = 'scale(1)';
  }

  zoomCloseBtn.addEventListener('click', closeZoom);

  zoomInBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    if (currentZoom < zoomMax) {
      currentZoom = Math.min(currentZoom + zoomStep, zoomMax);
      zoomImage.style.transform = `scale(${currentZoom})`;
    }
  });

  zoomOutBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    if (currentZoom > zoomMin) {
      currentZoom = Math.max(currentZoom - zoomStep, zoomMin);
      zoomImage.style.transform = `scale(${currentZoom})`;
    }
  });

  // Delete image and Undo functionality
  function deleteImage(idx) {
    deletedImageData = imageArray[idx];
    deletedImageIndex = idx;
    imageArray.splice(idx, 1);
    renderGallery();
    showUndoToast();
  }

  undoBtn.addEventListener('click', () => {
    if (deletedImageData && deletedImageIndex !== null) {
      imageArray.splice(deletedImageIndex, 0, deletedImageData);
      deletedImageData = null;
      deletedImageIndex = null;
      renderGallery();
      hideUndoToast();
    }
  });

  let undoTimeoutId;

  function showUndoToast() {
    undoToast.classList.add('show');
    undoToast.focus();
    undoTimeoutId = setTimeout(() => {
      hideUndoToast();
      deletedImageData = null;
      deletedImageIndex = null;
    }, 7000);
  }

  function hideUndoToast() {
    undoToast.classList.remove('show');
    clearTimeout(undoTimeoutId);
  }

  undoToast.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      hideUndoToast();
      deletedImageData = null;
      deletedImageIndex = null;
    }
  });

  // Go to top button
  goTopBtn.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  // Initial gallery render
  renderGallery();

});

</script>

<script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>

</body>
</html>



