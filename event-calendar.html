<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Official page of Avishikta - I Type - A RWA. Stay informed, get involved, and build a stronger association.">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta name="theme-color" content="#000000" />
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Your site CSS -->
  <link rel="stylesheet" href="css/responsive-fix.css" />

  <!-- Your layout script with header/sidebar/footer -->
  <script src="layout-loader.js"></script>
  <title>Interactive Event Calendar</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body, html, #root {
      height: 100%;
      background: #f0f2f5;
    }

    .main-content {
      margin-left: 5%;
      padding: 10px 5px;
      display: flex;
      gap: 10px;
      height: calc(100vh - 120px);
    }

  #calendarContainer {
  flex: 1 1 60%;
  background: linear-gradient(135deg, #ffffff, #f4f8fd);
  backdrop-filter: blur(10px);
  border: 1px solid #dfe8f3;
  border-radius: 16px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
  padding: 24px;
  display: flex;
  flex-direction: column;
  transition: background 0.3s ease-in-out;
}

    .calendar-header {
      display: flex;
      align-items: center; 
      justify-content: space-between;
      margin-bottom: 10px;
      flex-wrap: wrap;
      gap: 6px;
    }

    .calendar-header h2 {
  font-weight: 700;
  font-size: 1.4rem;
  /* gradient text */
  background: linear-gradient(90deg, #6a11cb, #2575fc, #00c6ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text; /* for Firefox */
  color: transparent; /* fallback */
  flex-grow: 1;
  min-width: 150px;
}


    .nav-buttons {
      display: flex;
      gap: 10px;
    }

    .nav-buttons button,
    #todayBtn {
      background: #2575fc;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      color: white;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.3s;
    }

    .nav-buttons button:hover,
    #todayBtn:hover {
      background: #1a5ed9;
    }

    #eventTypeFilter {
      padding: 8px 12px;
      border-radius: 6px;
      border: 1.5px solid #ccc;
      font-weight: 600;
      font-size: 1rem;
      background: white;
      cursor: pointer;
    }

    #calendarGrid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 10px;
      row-gap: 6px;
      column-gap: 6px;
    }

    #calendarGrid > div {
      text-align: center;
      font-weight: 700;
      padding: 6px 0;
      color: #666;
    }

    .day, .day.empty {
  height: 60px;
  border-radius: 12px;
  background: #eef2f7;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: 600;
  color: #444;
  cursor: pointer;
  position: relative;
  transition: all 0.3s ease;
  user-select: none;
  padding: 0;
  font-size: 0.95rem;
  box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);
}


    .day.empty {
      background: transparent;
      cursor: default;
    }

    .day:hover:not(.empty) {
  background: #d8eaff;
  transform: scale(1.03);
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

    .event-day {
      color: white;
      font-weight: 700;
      box-shadow: 0 0 8px rgba(0,0,0,0.15);
    }

    .event-icon {
      position: absolute;
      bottom: 6px;
      right: 6px;
      font-size: 1.2rem;
    }

    .today-highlight {
      outline: 4px solid #ffab00;
      outline-offset: -4px;
      border-radius: 10px;
    }

  #upcomingSidebar {
  width: 450px; /* Adjusted width */
  flex: none;
  background: linear-gradient(135deg, #6a11cb, #2575fc);
  color: white;
  border-radius: 12px;
  padding: 15px;
  overflow-y: auto;
  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  max-height: 100%;
}

#upcomingSidebar h3 {
  margin-bottom: 15px;
  font-weight: 700;
  font-size: 1.1rem;
  border-bottom: 2px solid rgba(255,255,255,0.4);
  padding-bottom: 8px;
}

#upcomingSidebar::-webkit-scrollbar {
  width: 8px;
}

#upcomingSidebar::-webkit-scrollbar-thumb {
  background-color: rgba(255,255,255,0.3);
  border-radius: 4px;
}

    .event-item {
      background: rgba(255, 255, 255, 0.15);
      margin-bottom: 12px;
      padding: 12px 15px;
      border-radius: 8px;
      box-shadow: inset 0 0 6px rgba(0,0,0,0.1);
      transition: background 0.3s;
    }

    .event-item:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .event-item .event-type {
      font-weight: 700;
      margin-bottom: 4px;
      text-transform: uppercase;
      font-size: 0.75rem;
      letter-spacing: 1px;
    }

    .event-item .event-name {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .event-item .event-date {
      font-size: 0.9rem;
      opacity: 1;
    }

    .event-type.religious {
    color: #ffe600; /* bright yellow */
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
    }

.event-type.national {
    color: #ff6f00; /* vivid orange */
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
}
.event-type.other {
    color: #00e5ff; /* bright cyan */
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    gap: 6px;
}
#eventModal[hidden] {
  display: none;
}

#eventModal {
  z-index: 1000;
}
#upcomingEventsList {
  display: grid;
  grid-template-columns: repeat(2, 1fr); /* Two equal-width columns */
  gap: 12px; /* Spacing between items */
}
@media (max-width: 500px) {
  #upcomingEventsList {
    grid-template-columns: 1fr !important; /* Fall back to single column */
  }
}
@media (max-width: 768px) {
  .main-content {
    flex-direction: column;
    margin-left: 0;
    padding: 10px;
    height: auto;
  }

  #upcomingSidebar {
    width: 100%;
    margin-top: 10px;
  }

  #calendarContainer {
    width: 100%;
    flex: none;
  }
}

</style>
</head>
<body>
<div id="root">
  <main id="main-content" class="main-content" role="main" tabindex="-1" style="display: flex; gap: 20px;">

  <section id="calendarContainer" style="flex: 1;">
    <div class="calendar-header" style="display: flex; flex-wrap: wrap; align-items: center; gap: 10px; margin-bottom: 10px;">
      <h2 id="calendarTitle" style="flex-grow: 1; min-width: 150px;">Loading...</h2>

      <div class="nav-buttons" style="display: flex; gap: 5px;">
        <button id="prevMonthBtn" aria-label="Previous month">&lt;</button>
        <button id="nextMonthBtn" aria-label="Next month">&gt;</button>
      </div>

      <div id="eventTypeFilters" aria-label="Filter events by event types" role="group" style="display: flex; gap: 15px; flex-wrap: wrap;">
        <label><input type="checkbox" value="religious" checked> Religious</label>
        <label><input type="checkbox" value="national" checked> National</label>
        <label><input type="checkbox" value="other" checked> Other</label>
      </div>

      <button id="todayBtn" aria-label="Go to today">Today</button>
    </div>

    <div id="calendarGrid" aria-label="Calendar days grid" role="grid" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px;"></div>

  </section>

  <aside id="upcomingSidebar" aria-live="polite" aria-atomic="true" tabindex="0">
  <h3>Upcoming Events</h3>

  <p style="font-style: italic; font-size: 0.9em; color: #ccc; margin-top: -6px; margin-bottom: 10px;">
    <b>Click a date on the calendar above to view event details and add reminders.</b>
  </p>

  <div id="upcomingEventsList" style="padding-right: 8px; margin-bottom: 10px;"></div>
</aside>


</main>

  <footer class="footer" role="contentinfo" style="text-align:center; padding:12px; color:#777;">
    ¬© 2025 My Calendar App
  </footer>
</div>

<!-- modal HTML here, before closing body -->
<div id="eventModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDesc" tabindex="-1" hidden>
  <div id="modalBackdrop" style="position:fixed; inset:0; background:rgba(0,0,0,0.5);"></div>
  <div id="modalContent" style="position:fixed; top:50%; left:50%; transform:translate(-50%, -50%);
    background:#fff; border-radius:12px; padding:20px; max-width:400px; box-shadow:0 8px 20px rgba(0,0,0,0.2);">
    <h2 id="modalTitle" style="margin-bottom:12px;"></h2>
    <div id="modalDesc" style="margin-bottom:20px;"></div>
    <button id="closeModalBtn" style="background:#2575fc; border:none; color:#fff; padding:8px 16px; border-radius:8px; cursor:pointer;">Close</button>
  </div>
</div>

<script>
  let eventModal, modalTitle, modalDesc, closeModalBtn;

  const eventColors = {
    religious: '#d1b3e0',  // adjusted purple for better contrast
    meeting: '#27ae60',
    national: '#e67e22',
  };

  const eventIcons = {
    religious: 'üôè',
    other: 'üìÖ',
    national: 'üéÜ',
  };

  const eventsData = {
    "2025-08-15": [{ type: "national", name: "Independence Day" }],
    "2025-08-25": [{ type: "other", name: "Valve Repair" }],
    "2025-08-27": [{ type: "religious", name: "Ganesh Chaturthi" }],
    "2025-09-05": [{ type: "national", name: "Teacher's Day" }],
    "2025-09-17": [{ type: "religious", name: "Biswakarma Puja" }],
    "2025-09-21": [{ type: "religious", name: "Mahalaya" }],
    "2025-09-29": [{ type: "religious", name: "Maha Saptami" }],
    "2025-09-30": [{ type: "religious", name: "Maha Astami" }],
    "2025-10-01": [{ type: "religious", name: "Maha Nabami" }],
    "2025-10-02": [{ type: "religious", name: "Bijoya Dasami" }],
  };

  let currentYear, currentMonth;

  window.onload = () => {
    eventModal = document.getElementById('eventModal');
    modalTitle = document.getElementById('modalTitle');
    modalDesc = document.getElementById('modalDesc');
    closeModalBtn = document.getElementById('closeModalBtn');

    closeModalBtn.onclick = () => {
      eventModal.hidden = true;
    };
    document.getElementById('modalBackdrop').onclick = () => {
      eventModal.hidden = true;
    };
    window.addEventListener('keydown', e => {
      if (e.key === 'Escape' && !eventModal.hidden) {
        eventModal.hidden = true;
      }
    });

    // Add change listeners for checkboxes
    document.querySelectorAll('#eventTypeFilters input[type="checkbox"]').forEach(chk => {
      chk.addEventListener('change', () => {
        generateCalendar();
        populateUpcomingEvents();
      });
    });

    // Month navigation buttons and today button handlers remain same:
    document.getElementById('todayBtn').addEventListener('click', () => {
      const today = new Date();
      currentYear = today.getFullYear();
      currentMonth = today.getMonth();
      generateCalendar();
      highlightToday();
      populateUpcomingEvents();
    });

    document.getElementById('prevMonthBtn').addEventListener('click', () => {
      currentMonth--;
      if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
      }
      generateCalendar();
      highlightToday();
      populateUpcomingEvents();
    });

    document.getElementById('nextMonthBtn').addEventListener('click', () => {
      currentMonth++;
      if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
      }
      generateCalendar();
      highlightToday();
      populateUpcomingEvents();
    });

    init();
  };

  function init() {
    const today = new Date();
    currentYear = today.getFullYear();
    currentMonth = today.getMonth();
    generateCalendar();
    highlightToday();
    populateUpcomingEvents();
  }

  function getSelectedEventTypes() {
    const checkboxes = document.querySelectorAll('#eventTypeFilters input[type="checkbox"]');
    return Array.from(checkboxes)
      .filter(chk => chk.checked)
      .map(chk => chk.value.toLowerCase());
  }

  function generateCalendar() {
    const selectedTypes = getSelectedEventTypes();
    const calendarGrid = document.getElementById('calendarGrid');
    const calendarTitle = document.getElementById('calendarTitle');

    calendarGrid.innerHTML = '';

    const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
    const lastDayOfMonth = new Date(currentYear, currentMonth + 1, 0);
    const monthName = firstDayOfMonth.toLocaleString('default', { month: 'long' });

    calendarTitle.textContent = `${monthName} ${currentYear}`;

    const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    dayNames.forEach(day => {
      const header = document.createElement('div');
      header.textContent = day;
      header.style.fontWeight = '700';
      header.style.textAlign = 'center';
      calendarGrid.appendChild(header);
    });

    const startDay = firstDayOfMonth.getDay();
    for (let i = 0; i < startDay; i++) {
      const empty = document.createElement('div');
      empty.className = 'day empty';
      calendarGrid.appendChild(empty);
    }

    for (let day = 1; day <= lastDayOfMonth.getDate(); day++) {
      const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
      const cell = document.createElement('div');
      cell.className = 'day';
      cell.setAttribute('tabindex', '0');
      cell.setAttribute('role', 'button');
      cell.setAttribute('aria-label', `Day ${day}`);
      cell.textContent = day;

      const events = eventsData[dateStr];
      if (
         events &&
         events.some(e => selectedTypes.includes(e.type.toLowerCase()))
      ) {

        // Show first matching event‚Äôs color and icon
        const firstMatch = events.find(e => selectedTypes.includes(e.type.toLowerCase()));
        if (firstMatch) {
          cell.classList.add('event-day');
          cell.style.backgroundColor = eventColors[firstMatch.type.toLowerCase()];
          const icon = document.createElement('span');
          icon.className = 'event-icon';
          icon.textContent = eventIcons[firstMatch.type.toLowerCase()];
          cell.appendChild(icon);
          cell.title = events.map(ev => ev.name).join(', ');
        }
      }

      cell.onclick = () => {
        showEventModal(dateStr, events || []);
      };

      cell.onkeydown = e => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          cell.click();
        }
      };

      calendarGrid.appendChild(cell);
    }
  }

  function highlightToday() {
    const today = new Date();
    if (today.getFullYear() === currentYear && today.getMonth() === currentMonth) {
      const calendarGrid = document.getElementById('calendarGrid');
      const firstDay = new Date(currentYear, currentMonth, 1).getDay();
      const index = 7 + firstDay + today.getDate() - 1;
      const cell = calendarGrid.children[index];
      if (cell && cell.classList.contains('day')) {
        cell.classList.add('today-highlight');
      }
    }
  }

  function populateUpcomingEvents() {
  const list = document.getElementById('upcomingEventsList');
  const selectedTypes = getSelectedEventTypes();
  const today = new Date();
  list.innerHTML = '';

  const upcoming = [];

  for (const [dateStr, events] of Object.entries(eventsData)) {
    const [y, m, d] = dateStr.split('-').map(Number);
    const localDate = new Date(y, m - 1, d);

    if (localDate >= today) {
      events.forEach(e => {
        if (selectedTypes.includes(e.type.toLowerCase())) {
          upcoming.push({ date: localDate, ...e });
        }
      });
    }
  }

  upcoming.sort((a, b) => a.date - b.date);

  if (upcoming.length === 0) {
    list.innerHTML = `<p style="font-style: italic;">No upcoming events.</p>`;
  } else {
    upcoming.forEach(e => {
      const item = document.createElement('div');
      item.className = 'event-item';
      item.innerHTML = `
        <div class="event-type ${e.type}">
  ${eventIcons[e.type.toLowerCase()] || 'üìÖ'} ${e.type.toUpperCase()}
</div>
        <div class="event-name">${e.name}</div>
        <div class="event-date">${e.date.toLocaleDateString(undefined, {
          weekday: 'short',
          month: 'short',
          day: 'numeric',
          year: 'numeric'
        })}</div>
      `;
      list.appendChild(item);
    });

  }
}

  // Helper to generate Google Calendar URL for an all-day event
  function generateGoogleCalendarURL(title, dateStr) {
    const [y, m, d] = dateStr.split('-').map(Number);
    const start = new Date(y, m - 1, d);
    const end = new Date(y, m - 1, d + 1);

    const formatDate = (date) =>
      date.toISOString().replace(/[-:]|\.\d{3}/g, '').slice(0, 15);

    const details = {
      action: 'TEMPLATE',
      text: encodeURIComponent(title),
      dates: `${formatDate(start)}/${formatDate(end)}`,
      details: encodeURIComponent('Reminder added from the calendar app'),
    };

    return `https://calendar.google.com/calendar/render?${Object.entries(details)
      .map(([k, v]) => `${k}=${v}`)
      .join('&')}`;
  }

  // Show event modal and include "Add to Google Calendar" links
  function showEventModal(dateStr, events) {
  modalTitle.textContent = `Events on ${dateStr}`;
  modalDesc.innerHTML = '';

  if (events.length === 0) {
    modalDesc.textContent = "No events on this day.";
  } else {
    events.forEach((e) => {
      const calendarUrl = generateGoogleCalendarURL(e.name, dateStr);

      const eventEntry = document.createElement('div');
      eventEntry.style.marginBottom = '10px';

      const eventTitle = document.createElement('strong');
      eventTitle.textContent = e.name;

      const eventType = document.createTextNode(` (${e.type.toUpperCase()})`);

      const br = document.createElement('br');

      const link = document.createElement('a');
      link.href = calendarUrl;
      link.target = '_blank';
      link.rel = 'noopener noreferrer';
      link.style.color = '#007bff';
      link.style.textDecoration = 'underline';
      link.textContent = '‚ûï Add to Google Calendar';

      eventEntry.appendChild(eventTitle);
      eventEntry.appendChild(eventType);
      eventEntry.appendChild(br);
      eventEntry.appendChild(link);

      modalDesc.appendChild(eventEntry);
    });

}

  eventModal.hidden = false;
  closeModalBtn.focus();
}

</script>

<!-- Event Details Modal -->
<div id="eventModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDesc" tabindex="-1" hidden>
  <div id="modalBackdrop" style="position:fixed; inset:0; background:rgba(0,0,0,0.5);"></div>
  <div id="modalContent" style="position:fixed; top:50%; left:50%; transform:translate(-50%, -50%);
    background:#fff; border-radius:12px; padding:20px; max-width:400px; box-shadow:0 8px 20px rgba(0,0,0,0.2);">
    <h2 id="modalTitle" style="margin-bottom:12px;"></h2>
    <div id="modalDesc" style="margin-bottom:20px;"></div>
    <button id="closeModalBtn" style="background:#2575fc; border:none; color:#fff; padding:8px 16px; border-radius:8px; cursor:pointer;">Close</button>
  </div>
</div>

</body>
</html>

