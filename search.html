<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Site Search</title>
  <meta name="description" content="Official page of Avishikta - I Type - A RWA. Stay informed, get involved, and build a stronger association.">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <!-- Confetti script from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <style>
    /* Reset and base */
    body {
  font-family: 'Arial', sans-serif;
  margin: 0;
  padding: 0;
  background: linear-gradient(90deg, #0d47a1, #1976d2); /* Dark blue to medium blue */
  color: #ffffff; /* White text */
  min-height: 100vh;
  display: flex;
  justify-content: flex-start;
  align-items: flex-start;
  flex-direction: column;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

    /* Container */
    .search-container {
      width: 100%;
      margin: 5px auto 80px auto;
      box-sizing: border-box; /* so padding is included in width */
      padding: 15px 20px;
      background-color: rgba(255, 255, 255, 0.95);
      border-radius: 14px;
      box-shadow: 0 8px 24px rgba(240, 101, 149, 0.25);
      text-align: center;
      position: relative;
      padding-top: 10px; /* or less */
    }

    @media (max-width: 768px) {
    .search-container {
    margin: 30px 15px 50px 15px; /* smaller side margins */
    padding: 25px 20px;
    max-width: 100%; /* full width on small screens */
  }
}

    /* Heading */
    .search-container h2 {
      background: linear-gradient(90deg, #f7c6d4, #f06595);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
      margin-top: 0;       /* Add this to remove top margin */
      margin-bottom: 24px;
    }

    /* Search input wrapper */
    .search-wrapper {
      position: relative;
      width: 100%;
      max-width: 100%;
      margin-bottom: 30px;
    }

    /* Input field */
    input[type="text"] {
      width: 100%;
      padding: 14px 45px 14px 40px;
      font-size: 15px;
      border-radius: 10px;
      border: 2px solid #e3a5bc;
      outline: none;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      box-sizing: border-box;
      color: #444;
      background-color: #fff;
      font-weight: 300;
    }

    input[type="text"]::placeholder {
      color: #d78fa1;
      font-style: italic;
    }

    input[type="text"]:focus {
      border-color: #d43766;
      box-shadow: 0 0 12px rgba(212, 55, 102, 0.5);
      background-color: #fff;
      color: #222;
    }

    /* Search icon inside input */
    .search-wrapper::before {
      content: 'üîç';
      position: absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 20px;
      color: #d43766;
      pointer-events: none;
    }

    /* Clear (X) button */
    .clear-search {
      position: absolute;
      right: 14px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      color: #d43766;
      font-size: 20px;
      user-select: none;
      display: none;
      transition: color 0.3s ease;
      font-weight: bold;
      line-height: 1;
    }

    .clear-search:hover {
      color: #a02649;
    }

    /* Example Searches box */
    .example-searches {
      background-color: #f7d3de;
      padding: 22px 30px;
      border-radius: 14px;
      margin-bottom: 30px;
      box-shadow: 0 3px 10px rgba(240, 101, 149, 0.15);
      user-select: none;
      font-weight: 600;
      letter-spacing: 0.4px;
      font-size: 0.8rem;
      color: #d43766;
    }

    .example-searches h3 {
      font-size: 1.2rem;
      color: #d43766;
      margin-bottom: 15px;
      font-weight: 700;
      letter-spacing: 0.5px;
    }

    .example-searches ul {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
    }

    .example-searches ul li {
      background-color: #d43766;
      color: white;
      border-radius: 25px;
      font-size: 16px;
      padding: 10px 18px;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s ease;
      box-shadow: 0 2px 8px rgba(212, 55, 102, 0.3);
      user-select: none;
      font-weight: 700;
      text-transform: none;
    }

    .example-searches ul li:hover {
      background-color: #a02649;
      box-shadow: 0 3px 12px rgba(160, 38, 73, 0.6);
    }

    /* Search results */
    #searchResults {
      margin-top: 10px;
      text-align: left;
      font-size: 16px;
      color: #444;
      max-height: 300px;
      overflow-y: auto;
      padding-right: 6px;
    }

    .result-item {
      background-color: #fff0f3;
      padding: 15px 18px;
      border-radius: 12px;
      margin-bottom: 14px;
      box-shadow: 0 1px 5px rgba(212, 55, 102, 0.1);
      transition: background-color 0.3s ease;
    }

    .result-item:hover {
      background-color: #ffd6e1;
    }

    .result-item h3 {
      margin: 0 0 6px 0;
      font-size: 12px;
      color: #b92e59;
    }

    .result-item p {
      font-size: 14px;
      color: #666;
      margin: 0;
      line-height: 1.3;
    }

    .result-item a {
      text-decoration: none;
      color: inherit;
      font-weight: 600;
      transition: color 0.3s ease;
    }

    .result-item a:hover {
      text-decoration: underline;
      color: #d43766;
    }

    /* Highlighted search term */
    .highlighted-text {
      background-color: #f9c2d1;
      padding: 0 4px;
      border-radius: 4px;
      font-weight: 700;
      color: #a02649;
    }

    /* Skeleton loader styling */
    .skeleton-loader {
      background-color: #ffe6ee;
      margin: 10px 0;
      border-radius: 10px;
      height: 60px;
    }

    /* Spinner animation */
    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    #loadingSpinner {
      display: none;
      width: 50px;
      height: 50px;
      border: 6px solid #ffe6ee;
      border-top: 6px solid #d43766;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
    }

    /* Scroll to Top Button */
    #scrollToTopBtn {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background-color: #d43766;
      color: white;
      border: none;
      border-radius: 50%;
      padding: 15px;
      font-size: 20px;
      cursor: pointer;
      display: none;
      transition: background-color 0.3s ease;
      box-shadow: 0 4px 12px rgba(212, 55, 102, 0.6);
      z-index: 15;
    }

    #scrollToTopBtn:hover {
      background-color: #a02649;
    }

    /* Suggestions dropdown */
    #suggestionsList {
      position: absolute;
      width: 100%;
      max-width: 100%;
      top: auto;
      left: 0;
      background: white;
      box-shadow: 0 8px 24px rgba(240, 101, 149, 0.2);
      border-radius: 0 0 14px 14px;
      max-height: 220px;
      overflow-y: auto;
      z-index: 20;
      display: none;
    }

    #suggestionsList .suggestion-item {
      padding: 12px 20px;
      border-bottom: 1px solid #f0c2d3;
      cursor: pointer;
      font-weight: 600;
      color: #d43766;
      transition: background-color 0.25s ease;
    }

    #suggestionsList .suggestion-item:hover {
      background-color: #f7d3de;
    }

    /* Mobile Responsiveness */
    @media (max-width: 768px) {
      .search-container {
        margin: 30px 15px 50px 15px;
        padding: 25px 20px;
        width: auto;
      }

      .search-container h2 {
        font-size: 1.6rem;
      }

      input[type="text"] {
        font-size: 16px;
        padding: 12px 45px 12px 38px;
      }

      .clear-search {
        font-size: 18px;
        right: 12px;
        z-index: 20;
      }

      .example-searches h3 {
        font-size: 1.2rem;
      }

      .example-searches ul li {
        font-size: 14px;
        padding: 9px 14px;
      }

      #searchResults {
        font-size: 15px;
        max-height: 250px;
      }

      #suggestionsList {
        top: 52px;
      }
    }
  </style>
</head>

<body>

  <main>
    <div class="search-container" role="search" aria-label="Site Search">
      <h2>Search the Website</h2>

      <div class="search-wrapper">
        <input type="text" id="searchInput" placeholder="Type to search..." aria-autocomplete="list" aria-controls="suggestionsList" aria-expanded="false" aria-haspopup="listbox" aria-activedescendant="" />
        <span id="clearSearch" class="clear-search" role="button" aria-label="Clear search input" tabindex="0">√ó</span>
      </div>

      <div id="loadingSpinner" aria-hidden="true"></div>

      <div class="example-searches" aria-live="polite" aria-atomic="true">
        <h3>Example Searches:</h3>
        <ul>
          <li tabindex="0">Who</li>
          <li tabindex="0">Events</li>
          <li tabindex="0">New Resident</li>
          <li tabindex="0">Feedback</li>
          <li tabindex="0">Rules</li>
          <li tabindex="0">Support Hub</li>
          <li tabindex="0">Download Center</li>
        </ul>
      </div>

      <div id="searchResults" role="region" aria-live="polite" aria-atomic="true"></div>

      <div id="suggestionsList" role="listbox"></div>
    </div>

    <button id="scrollToTopBtn" onclick="scrollToTop()" aria-label="Scroll to top">‚Üë</button>
  </main>

  <script>
    // Site menu & pages data
    const pages = [
      { menu: "Association", title: "Who We Are", url: "about-us.html", content: "About the association's purpose, history, and members." },
      { menu: "Association", title: "Vision & Mission", url: "vision-mission.html", content: "The vision and mission statement of our association." },
      { menu: "Association", title: "Executive Committee", url: "governing-body.html", content: "Information about the governing body and its members." },
      { menu: "Association", title: "Residents Directory", url: "our-members.html", content: "A list of all residents and their contact information." },
      { menu: "Resources", title: "News & Buzz", url: "view-announcements.html", content: "Latest news and updates about the association." },
      { menu: "Resources", title: "Event Calendar", url: "events.html", content: "List of upcoming events and important dates." },
      { menu: "Resources", title: "Meeting Minutes", url: "mom.html", content: "Minutes from past meetings and discussions." },
      { menu: "Resources", title: "New Resident Guide", url: "new-resident-guide.html", content: "Helpful guide for new residents in the community." },
      { menu: "Resources", title: "Community Guidelines", url: "general-guidelines.html", content: "The guidelines and rules for living in the community." },
      { menu: "Resources", title: "Support Hub", url: "useful-links.html", content: "Helpful resources and support links." },
      { menu: "Resources", title: "Download Center", url: "download-center.html", content: "Access downloadable documents and files." },
      { menu: "Resources", title: "Projects & Upgrades", url: "projects.html", content: "Information on current and upcoming projects." },
      { menu: "Get Involved", title: "Give Feedback", url: "feedback.html", content: "Submit your feedback to help improve our community." },
      { menu: "Get Involved", title: "Volunteer Opportunities", url: "volunteer.html", content: "Learn how to volunteer and contribute." },
      { menu: "Get in Touch", title: "Contact Us", url: "contact-us.html", content: "Get in touch with the association team." },
      { menu: "Get in Touch", title: "FAQs", url: "faq.html", content: "Frequently asked questions and answers." },
      { menu: "Find & Explore", title: "Site Search", url: "search.html", content: "Search the entire website content." },
      { menu: "Find & Explore", title: "Event Calendar", url: "event-calendar.html", content: "Calendar view of upcoming events." },
    ];

    // Debounce timer
    let debounceTimer;

    // DOM Elements
    const searchInput = document.getElementById('searchInput');
    const results = document.getElementById('searchResults');
    const clearButton = document.getElementById('clearSearch');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const suggestionsList = document.getElementById('suggestionsList');

    // Search function - triggered on keyup/input
    function searchFunction() {
      const query = searchInput.value.trim().toLowerCase();

      // Clear previous results and suggestions
      results.innerHTML = '';
      suggestionsList.innerHTML = '';
      suggestionsList.style.display = 'none';

      clearTimeout(debounceTimer);
      loadingSpinner.style.display = 'block';

      debounceTimer = setTimeout(() => {
        loadingSpinner.style.display = 'none';

        if (!query) {
          clearButton.style.display = 'none';
          results.innerHTML = `<p style="color:#d43766; font-weight: 600;">Start typing to search pages...</p>`;
          return;
        }

        clearButton.style.display = 'inline';

        // Filter pages based on title, menu, or content
        const matchedPages = pages.filter(page =>
          page.title.toLowerCase().includes(query) ||
          page.menu.toLowerCase().includes(query) ||
          page.content.toLowerCase().includes(query)
        );

        if (matchedPages.length === 0) {
          results.innerHTML = `<p style="color:#a02649; font-weight: 600;">No results found for "<span class="highlighted-text">${escapeHtml(query)}</span>"</p>`;
          return;
        }

        // Render results
        results.innerHTML = matchedPages.map(page => {
          const highlightedTitle = highlightTerm(page.title, query);
          const highlightedMenu = highlightTerm(page.menu, query);
          const highlightedContent = highlightTerm(page.content, query);
          return `
            <div class="result-item">
              <h3><a href="${page.url}" tabindex="0">${highlightedTitle}</a></h3>
              <p><strong>Menu:</strong> ${highlightedMenu}</p>
              <p>${highlightedContent}</p>
            </div>
          `;
        }).join('');

        // Show suggestions (top 5 matching titles)
        const suggestionItems = matchedPages.slice(0, 5).map(page => {
          return `<div class="suggestion-item" role="option" tabindex="0">${escapeHtml(page.title)}</div>`;
        }).join('');

        if (suggestionItems.length > 0) {
          suggestionsList.innerHTML = suggestionItems;
          suggestionsList.style.display = 'block';
          searchInput.setAttribute('aria-expanded', 'true');
        } else {
          suggestionsList.style.display = 'none';
          searchInput.setAttribute('aria-expanded', 'false');
        }

      }, 350);
    }

    // Clear search input
    function clearSearch() {
      searchInput.value = '';
      results.innerHTML = '<p style="color:#d43766; font-weight: 600;">Start typing to search pages...</p>';
      clearButton.style.display = 'none';
      suggestionsList.innerHTML = '';
      suggestionsList.style.display = 'none';
      searchInput.focus();
      searchInput.setAttribute('aria-expanded', 'false');
    }

    // Escape HTML characters
    function escapeHtml(text) {
      return text.replace(/[&<>"']/g, function (m) {
        switch (m) {
          case '&':
            return '&amp;';
          case '<':
            return '&lt;';
          case '>':
            return '&gt;';
          case '"':
            return '&quot;';
          case "'":
            return '&#039;';
          default:
            return m;
        }
      });
    }

    // Highlight matched search terms
    function highlightTerm(text, term) {
      if (!term) return escapeHtml(text);
      const regex = new RegExp(`(${term.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&')})`, 'gi');
      return escapeHtml(text).replace(regex, '<span class="highlighted-text">$1</span>');
    }

    // Scroll to top button behavior
    const scrollBtn = document.getElementById('scrollToTopBtn');
    window.onscroll = function () {
      if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
        scrollBtn.style.display = 'block';
      } else {
        scrollBtn.style.display = 'none';
      }
    };

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Event listeners
    searchInput.addEventListener('input', searchFunction);

    clearButton.addEventListener('click', clearSearch);
    clearButton.addEventListener('keydown', e => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        clearSearch();
      }
    });

    // Example searches click
    document.querySelectorAll('.example-searches ul li').forEach(item => {
      item.addEventListener('click', () => {
        searchInput.value = item.textContent;
        searchFunction();
        searchInput.focus();
      });
      item.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          searchInput.value = item.textContent;
          searchFunction();
          searchInput.focus();
        }
      });
    });

    // Suggestions keyboard navigation and click
    suggestionsList.addEventListener('click', (e) => {
      if (e.target.classList.contains('suggestion-item')) {
        searchInput.value = e.target.textContent;
        suggestionsList.style.display = 'none';
        searchInput.setAttribute('aria-expanded', 'false');
        searchFunction();
        searchInput.focus();
      }
    });

    suggestionsList.addEventListener('keydown', (e) => {
      if (e.target.classList.contains('suggestion-item')) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          searchInput.value = e.target.textContent;
          suggestionsList.style.display = 'none';
          searchInput.setAttribute('aria-expanded', 'false');
          searchFunction();
          searchInput.focus();
        }
        if (e.key === 'ArrowDown') {
          e.preventDefault();
          if (e.target.nextElementSibling) {
            e.target.nextElementSibling.focus();
          }
        }
        if (e.key === 'ArrowUp') {
          e.preventDefault();
          if (e.target.previousElementSibling) {
            e.target.previousElementSibling.focus();
          } else {
            searchInput.focus();
          }
        }
        if (e.key === 'Escape') {
          suggestionsList.style.display = 'none';
          searchInput.setAttribute('aria-expanded', 'false');
          searchInput.focus();
        }
      }
    });

    // Accessibility: Close suggestions on Escape
    searchInput.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        suggestionsList.style.display = 'none';
        searchInput.setAttribute('aria-expanded', 'false');
      }
      if (e.key === 'ArrowDown') {
        e.preventDefault();
        const firstSuggestion = suggestionsList.querySelector('.suggestion-item');
        if (firstSuggestion) firstSuggestion.focus();
      }
    });

    // Initialize
    window.onload = () => {
      results.innerHTML = '<p style="color:#d43766; font-weight: 600;">Start typing to search pages...</p>';
      clearButton.style.display = 'none';
    };
  </script>

<script src="layout-loader.js"></script>
</body>

</html>
